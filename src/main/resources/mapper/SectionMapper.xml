<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="net.herdao.hdp.manpower.mpclient.mapper.SectionMapper">

    <resultMap id="sectionDTOMap" type="net.herdao.hdp.manpower.mpclient.dto.section.SectionDTO">
        <result property="stop" column="IS_STOP"/>
        <association property="group" column="group_id" javaType="group"
                     select="net.herdao.hdp.manpower.mpclient.mapper.GroupMapper.selectById" />
    </resultMap>

    <select id="query" resultMap="sectionDTOMap" parameterType="String">
        <bind name="likeTxt" value="'%'+searchTxt+'%'"/>
        select * from mp_section where section_code like #{likeTxt} or section_name like #{likeTxt}
    </select>

    <select id="sectionList"  resultType="map">
       	select id,section_code AS code,section_name AS name  from mp_section where group_id = #{groupId}
    </select>

    <select id="chkDuplicateSectionCode" parameterType="section" resultType="boolean" >
        SELECT count(*) from mp_section  where  (#{id} is null or  id != #{id})  and  section_code = #{sectionCode}
    </select>

    <select id="chkDuplicateSectionName" parameterType="section" resultType="boolean">
        SELECT count(*) from mp_section  where  (#{id} is null or  id != #{id})  and  section_name = #{sectionName}
    </select>

    <select id="getSectionCodesByGroupId" parameterType="long" resultType="String">
      SELECT SECTION_CODE from mp_section where group_id = #{groupId}
    </select>

</mapper>
