<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="net.herdao.hdp.manpower.mpclient.mapper.UserpostMapper">

  <resultMap id="userpostMap" type="net.herdao.hdp.manpower.mpclient.entity.Userpost">
                  <id property="id" column="id"/>
                  <result property="oid" column="OID"/>
                  <result property="userOid" column="USER_OID"/>
                  <result property="postOid" column="POST_OID"/>
                  <result property="orgOid" column="ORG_OID"/>
                  <result property="orgDeptOid" column="ORG_DEPT_OID"/>
                  <result property="userId" column="USER_ID"/>
                  <result property="postId" column="POST_ID"/>
                  <result property="orgId" column="ORG_ID"/>
                  <result property="orgDeptId" column="ORG_DEPT_ID"/>
                  <result property="mainPost" column="MAIN_POST"/>
                  <result property="actualJob" column="ACTUAL_JOB"/>
                  <result property="creatorCode" column="CREATOR_CODE"/>
                  <result property="createdTime" column="CREATED_TIME"/>
                  <result property="modifierCode" column="MODIFIER_CODE"/>
                  <result property="modifiedTime" column="MODIFIED_TIME"/>
                  <result property="isVirtual" column="IS_VIRTUAL"/>
                  <result property="startDate" column="START_DATE"/>
                  <result property="endDate" column="END_DATE"/>
                  <result property="administrativeLevel" column="ADMINISTRATIVE_LEVEL"/>
                  <result property="tenantId" column="TENANT_ID"/>
  </resultMap>

      <!-- 现任职情况 -->
      <select id="findUserPostNowPage" resultType="net.herdao.hdp.manpower.mpclient.dto.UserpostNow">
          SELECT  S.STAFF_NAME staffName,
                  S.STAFF_CODE staffCode,
                  u.START_DATE startDate,
                  a.ORG_NAME orgName,
                  sec.SECTION_NAME  sectionName,
                  pi.PIPELINE_NAME pipelineName,
                  p.POST_NAME postName,
                  p.JOB_LEVEL_CODE jobLevelCode,
                  di.label customPost
             FROM  mp_userpost u
                  LEFT JOIN mp_organization a ON u.ORG_DEPT_ID = a.ID  	AND u.MAIN_POST = 1
                  LEFT JOIN mp_staff s ON u.USER_ID = s.USER_ID
                  LEFT JOIN mp_post p on p.ID=u.POST_ID
                  LEFT JOIN mp_section sec on sec.id=p.SECTION_CODE
                  LEFT JOIN mp_pipeline pi on pi.id=p.PIPELINE_CODE
                  LEFT JOIN sys_dict_item  di on di.id= u.office_post_type
                    WHERE 1=1
                    and u.del_flag = 0
                  <if test="orgId != null">
                      and u.ORG_DEPT_ID = #{orgId}
                  </if>
                  <if test="staffName != null">
                      or s.staff_name LIKE concat(#{staffName},'%')
                  </if>
                  <if test="staffCode != null">
                      or s.staff_code LIKE concat(#{staffCode},'%')
                  </if>
      </select>

</mapper>
